var modalContent = "<%= j render(partial: 'bookings/new') %>";
var modal = document.getElementById('mainModal');

var closeModal = () => {
  modal.classList.remove('in');
  modal.style.display = 'none';
}

var openModal = () => {
  modal.classList.add('in');
  modal.style.display = 'block';
}

modal.querySelector('.modal-content').innerHTML = modalContent;
openModal();

var cancelBtn = document.getElementById('closeButton');
cancelBtn.addEventListener('click', closeModal);

document.addEventListener("click", function(evt) {
    var flyoutElement = document.querySelector('.modal-dialog'),
        calendars = document.querySelectorAll('.flatpickr-calendar'),
        targetElement = evt.target;  // clicked element

    do {
        if (targetElement == flyoutElement ||
            targetElement == calendars[0] ||
            targetElement == calendars[1]) {
            // This is a click inside. Do nothing, just return.
            return;
        }
        // Go up the DOM
        targetElement = targetElement.parentNode;
    } while (targetElement);

    // This is a click outside.
    closeModal()
});
